# –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ Admin Analytics

## –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∞–Ω–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ DTO –¥–ª—è `/api/v1/admin/`

**–°—Ç–∞—Ä–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ (Legacy):**
```typescript
{
  summary: { totalRevenue, potentialLostRevenue, totalBookings, ... }
  statusBreakdown: [...]
  revenueTrend: [...]
  bookingSources: [...]
  roomPerformance: [...]
}
```

**–ù–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**
```typescript
{
  period: { startDate, endDate, totalDays }
  summary: {
    revenue: { total, confirmed, cancelled, average }
    bookings: { total, confirmed, cancelled, active, completed, cancellationRate }
    guests: { total, averagePerBooking }
    occupancy: { rate, totalBedNights, occupiedBedNights }
  }
  trends: {
    daily: [...]
    weekly?: [...]
    monthly?: [...]
  }
  breakdown: {
    byStatus: [...]
    bySources: [...]
  }
  performance: {
    rooms: [...]
    categories: [...]
  }
  insights: {
    busiestDays: [...]
    topRooms: [...]
    averageLeadTime: number
    averageStayDuration: number
  }
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω –∞–¥–∞–ø—Ç–µ—Ä –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

Frontend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç —Å—Ç–∞—Ä—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É API –≤ –Ω–æ–≤—É—é. –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å —Ç–µ–∫—É—â–∏–º API –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
- ‚úÖ –ö–æ–≥–¥–∞ backend –æ–±–Ω–æ–≤–∏—Ç—Å—è, –∞–¥–∞–ø—Ç–µ—Ä –º–æ–∂–Ω–æ –±—É–¥–µ—Ç —É–¥–∞–ª–∏—Ç—å
- ‚úÖ –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –±–µ–∑ breaking changes

**–§–∞–π–ª:** [lib/api.ts](lib/api.ts:823-943)

### 3. –û–±–Ω–æ–≤–ª–µ–Ω Dashboard –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

**–ù–æ–≤—ã–µ —Å–µ–∫—Ü–∏–∏:**
- ‚úÖ –ú–µ—Ç—Ä–∏–∫–∞ –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç–∏ (Occupancy Rate)
- ‚úÖ –†–∞–∑–±–∏–≤–∫–∞ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–π
- ‚úÖ –¢–æ–ø-5 –∫–æ–º–Ω–∞—Ç –ø–æ –¥–æ—Ö–æ–¥—É
- ‚úÖ –¢–æ–ø-5 —Å–∞–º—ã—Ö –∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π
- ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–∞—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∫–æ–º–Ω–∞—Ç

**–§–∞–π–ª:** [components/dashboard-overview.tsx](components/dashboard-overview.tsx)

### 4. –£–ª—É—á—à–µ–Ω–∏—è –≤ UI

**–ö–∞—Ä—Ç–æ—á–∫–∏ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏:**
- –û–±—â–∏–π –¥–æ—Ö–æ–¥ ‚Üí —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ä–µ–¥–Ω–∏–π —á–µ–∫
- –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –∏ –∞–∫—Ç–∏–≤–Ω—ã–µ
- **–ù–æ–≤–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞**: –ó–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç—å —Å –ø—Ä–æ—Ü–µ–Ω—Ç–æ–º –∏ –∫–æ–π–∫–æ-–Ω–æ—á–∞–º–∏
- –û—Ç–º–µ–Ω—ã ‚Üí –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ–Ω—Ç –∏ —Å—É–º–º—É —É–ø—É—â–µ–Ω–Ω–æ–≥–æ –¥–æ—Ö–æ–¥–∞

**–ì—Ä–∞—Ñ–∏–∫–∏:**
- –ì—Ä–∞—Ñ–∏–∫ —Ç—Ä–µ–Ω–¥–æ–≤ —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –±–æ–ª—å—à–µ –º–µ—Ç—Ä–∏–∫ (guests, averageRate)
- –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–Ω–∞—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∑–∞–Ω—è—Ç–æ—Å—Ç—å —á–µ—Ä–µ–∑ progress bar
- –î–æ–±–∞–≤–ª–µ–Ω—ã —Å–µ–∫—Ü–∏–∏ –¥–ª—è insights

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã

1. **lib/api.ts**
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ TypeScript –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
   - –î–æ–±–∞–≤–ª–µ–Ω—ã Legacy –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã –¥–ª—è —Å—Ç–∞—Ä–æ–≥–æ API
   - –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω –∞–¥–∞–ø—Ç–µ—Ä `transformLegacyAnalytics()`

2. **components/dashboard-overview.tsx**
   - –û–±–Ω–æ–≤–ª–µ–Ω—ã –≤—Å–µ —Å–µ–∫—Ü–∏–∏ –ø–æ–¥ –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É
   - –î–æ–±–∞–≤–ª–µ–Ω—ã –Ω–æ–≤—ã–µ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏
   - –£–ª—É—á—à–µ–Ω–æ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

3. **NEW_ANALYTICS_DTO_SPEC.md** (–Ω–æ–≤—ã–π —Ñ–∞–π–ª)
   - –ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã DTO
   - –ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö
   - –§–æ—Ä–º—É–ª—ã –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤
   - TODO —Å–ø–∏—Å–æ–∫ –¥–ª—è backend

## –î–ª—è Backend —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

üìÑ **–ü–æ–ª–Ω–∞—è —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è:** [NEW_ANALYTICS_DTO_SPEC.md](NEW_ANALYTICS_DTO_SPEC.md)

### –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ—Ç–æ—Ä—ã–µ –Ω—É–∂–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

1. **Occupancy –º–µ—Ç—Ä–∏–∫–∏** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –≤–∞–∂–Ω–æ –¥–ª—è —Ö–æ—Å—Ç–µ–ª–∞
   ```typescript
   occupancy: {
     rate: 78.5,  // –ø—Ä–æ—Ü–µ–Ω—Ç –∑–∞–ø–æ–ª–Ω—è–µ–º–æ—Å—Ç–∏
     totalBedNights: 1240,
     occupiedBedNights: 973
   }
   ```

2. **Category Performance** - –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
   ```typescript
   categories: [{
     categoryId: 1,
     categoryName: "women-6",
     bookings: 45,
     revenue: 67500,
     rooms: 3,
     averageRate: 1500,
     occupancyRate: 82.3
   }]
   ```

3. **Enhanced Insights** - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
   ```typescript
   insights: {
     busiestDays: [...],
     topRooms: [...],
     averageLeadTime: 5.5,      // —Å—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –¥–æ –∑–∞–µ–∑–¥–∞
     averageStayDuration: 3.2   // —Å—Ä–µ–¥–Ω—è—è –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–µ–±—ã–≤–∞–Ω–∏—è
   }
   ```

4. **–ë–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω—ã–µ trend –¥–∞–Ω–Ω—ã–µ**
   ```typescript
   {
     date: "2025-01-15",
     revenue: 4500,
     bookings: 3,
     guests: 7,           // ‚Üê –¥–æ–±–∞–≤–∏—Ç—å
     averageRate: 1500
   }
   ```

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–µ–π—á–∞—Å

```
Backend (old API) ‚Üí transformLegacyAnalytics() ‚Üí New Structure ‚Üí Dashboard UI
     ‚Üì
[Legacy format]         [Adapter]              [New format]      [React]
```

## –ß—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ

### –î–ª—è Frontend:
- ‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤–æ –∫ —Ä–∞–±–æ—Ç–µ
- ‚è≥ –ö–æ–≥–¥–∞ backend –æ–±–Ω–æ–≤–∏—Ç—Å—è - —É–¥–∞–ª–∏—Ç—å –∞–¥–∞–ø—Ç–µ—Ä

### –î–ª—è Backend:
1. –ü—Ä–æ—á–∏—Ç–∞—Ç—å [NEW_ANALYTICS_DTO_SPEC.md](NEW_ANALYTICS_DTO_SPEC.md)
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –Ω–æ–≤—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É DTO
3. –û–±–Ω–æ–≤–∏—Ç—å endpoint `/api/v1/admin/`
4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å frontend

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã

‚úÖ **–õ—É—á—à–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö** - –ª–æ–≥–∏—á–µ—Å–∫–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –º–µ—Ç—Ä–∏–∫
‚úÖ **–ë–æ–ª—å—à–µ insights** - occupancy, lead time, stay duration
‚úÖ **–†–∞—Å—à–∏—Ä—è–µ–º–æ—Å—Ç—å** - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏
‚úÖ **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏–π** - –≤–∞–∂–Ω–æ –¥–ª—è –±–∏–∑–Ω–µ—Å-–∞–Ω–∞–ª–∏—Ç–∏–∫–∏
‚úÖ **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–∏–æ–¥—ã** - daily/weekly/monthly —Ç—Ä–µ–Ω–¥—ã

## –í–æ–ø—Ä–æ—Å—ã?

–ï—Å–ª–∏ –µ—Å—Ç—å –≤–æ–ø—Ä–æ—Å—ã –ø–æ –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏–ª–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ - —Å–º–æ—Ç—Ä–∏—Ç–µ:
- –ü–æ–ª–Ω—É—é —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é: [NEW_ANALYTICS_DTO_SPEC.md](NEW_ANALYTICS_DTO_SPEC.md)
- –ö–æ–¥ –∞–¥–∞–ø—Ç–µ—Ä–∞: [lib/api.ts](lib/api.ts:823-943)
- UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç: [components/dashboard-overview.tsx](components/dashboard-overview.tsx)
